/******************************************************************************
*        
*     Open source
*        
*******************************************************************************
*  file name:          sha256.h
*  author:              Chen Hao
*  version:             1.00
*  file description:   sha256 header file
*******************************************************************************
*  revision history:    date               version                  author
*
*  change summary:   2018-4-23             1.00                    Chen Hao
*
******************************************************************************/
#ifndef __SHA256_H__
#define __SHA256_H__
/******************************************************************************
* Include Files
******************************************************************************/
#include "basetype.h"

/******************************************************************************
* Macros
******************************************************************************/
#define SHA256_DIGEST_SIZE (32)
#define SHA256_BLOCK_SIZE  (64)

/******************************************************************************
* Types
******************************************************************************/
typedef struct 
{
    uint32 tot_len;
    uint32 len;
    uint8 block[2 * SHA256_BLOCK_SIZE];
    uint32 h[8];
} sha256_ctx;

/******************************************************************************
* Extern functions
******************************************************************************/
void sha256_init(sha256_ctx * ctx);
void sha256_update(sha256_ctx *ctx, const uint8 *message, uint32 len);
void sha256_final(sha256_ctx *ctx, uint8 *digest);
void sha256(const uint8 *message, uint32 len, uint8 *digest);

#endif /* __SHA256_H__ */

